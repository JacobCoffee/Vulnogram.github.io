function orderKeys(obj){var i,keys=Object.keys(obj).sort(function(k1,k2){return k1<k2?-1:k1>k2?1:0}),after={};for(i=0;i<keys.length;i++)after[keys[i]]=obj[keys[i]],delete obj[keys[i]];for(i=0;i<keys.length;i++)obj[keys[i]]=after[keys[i]],obj[keys[i]]instanceof Object&&(obj[keys[i]]=orderKeys(obj[keys[i]]));return obj}function cloneJSON(obj){if(null===obj||void 0===obj||"object"!=typeof obj||""===obj)return obj;if(obj instanceof Array){for(var cloneA=[],i=0;i<obj.length;++i)cloneA[i]=cloneJSON(obj[i]);return cloneA.length>0?cloneA:null}var cloneO={};for(var i in obj){var c=cloneJSON(obj[i]);null!==c&&""!==c&&(cloneO[i]=c)}return cloneO}function loadimg(e){var sibs=this.parentNode.parentNode.childNodes,f=sibs[1],ok=sibs[4];e.preventDefault();var file=this.files[0];if(file.size>528385)return alert("Image size should less than 500k"),!1;if(-1==file.type.indexOf("image"))return alert("Not an image!"),!1;var reader=new FileReader;return reader.onload=function(event){f.value=event.target.result,ok.click()},reader.readAsDataURL(file),!1}var textUtil={jsonView:function(obj){if(obj instanceof Array){var ret="<table>";for(var k in obj)ret=ret+"<tr><td>"+this.jsonView(obj)+"</td></tr>";return ret+"</table>"}if(obj instanceof Object){ret="<div>";for(var k in obj)obj.hasOwnProperty(k)&&(ret=ret+"<div><b>"+k+"</b>: "+this.jsonView(obj[k])+"</div>");return ret+"</div>"}return obj},reduceJSON:function(cve){var c=cloneJSON(cve);if(delete c.CNA_private,c.description&&c.description.description_data){var d,merged={};for(d of c.description.description_data)d&&d.lang&&(merged[d.lang]||(merged[d.lang]=[]),merged[d.lang].push(d.value));var new_d=[];for(var m in merged)new_d.push({lang:m,value:merged[m].join("\n")});c.description.description_data=new_d}return c.impact&&c.impact.cvss&&0===c.impact.cvss.baseScore&&delete c.impact,orderKeys(c)},getMITREJSON:function(cve){return JSON.stringify(cve,null,"    ")},getPR:function(cve){for(var m,matches=[],re=/PRs?[ \t]+((or|and|[0-9\t\ \,])+)/gim;null!==(m=re.exec(cve.solution));){var prs=m[1].trim().split(/[ \t,andor]{1,}/).filter(x=>x);matches=matches.concat(prs)}return matches},getAffectedProductString:function(cve){var status={};for(var vendor of cve.affects.vendor.vendor_data){var vendor_name=vendor.vendor_name;for(var product of vendor.product.product_data)for(var version of product.version.version_data){var vv=version.version_value,cat="affected";if(version.version_affected){version.version_affected.startsWith("?")?cat="unknown":version.version_affected.startsWith("!")&&(cat="unaffected");var prefix=product.product_name+" ";switch(version.version_name&&""!=version.version_name&&(prefix+=version.version_name+" "),version.version_affected){case"!":case"?":case"=":vv=version.version_value;break;case"<":case"!<":case"?<":vv=prefix+"versions earlier than "+version.version_value;break;case">":case"?>":vv=prefix+"versions later than "+version.version_value;break;case"<=":case"!<=":case"?<=":vv=product.product_name+" "+version.version_value+" and earlier versions";break;case">=":case"!>=":case"?>=":vv=product.product_name+" "+version.version_value+" and later versions";break;default:vv=version.version_value}}version.platform&&(vv=vv+" on "+version.platform),status[cat]||(status[cat]={}),status[cat][vendor_name+" "+product.product_name]||(status[cat][vendor_name+" "+product.product_name]=[]),status[cat][vendor_name+" "+product.product_name].push(vv)}}var stringifyArray=function(ob){var ret=[];for(var p in ob)ret.push(p+"\n"+ob[p].join(";\n")+".");return ret.join("\n")},ret=[];return status.affected&&ret.push("This issue affects:\n"+stringifyArray(status.affected)),status.unaffected&&ret.push("This issue does not affect:\n"+stringifyArray(status.unaffected)),status.unknown&&ret.push("It is not known whether this issue affects:\n"+stringifyArray(status.unknown)),ret.join("\n\n")},affectedTable:function(cve){var status={};for(var vendor of cve.affects.vendor.vendor_data){var vendor_name=vendor.vendor_name;for(var product of(status[vendor_name]||(status[vendor_name]={}),vendor.product.product_data)){var product_name=product.product_name;for(var version of(status[vendor_name][product_name]||(status[vendor_name][product_name]={}),product.version.version_data)){var vv=version.version_value,cat="affected";vn="";if(version.version_name&&""!=version.version_name&&(vn=version.version_name),version.version_affected)switch(version.version_affected.startsWith("?")?cat="unknown":version.version_affected.startsWith("!")&&(cat="unaffected"),version.version_affected){case"!":case"?":case"=":vv=version.version_value;break;case"<":case"!<":case"?<":vv="< "+version.version_value;break;case">":case"?>":vv="> "+version.version_value;break;case"<=":case"!<=":case"?<=":vv="<= "+version.version_value;break;case">=":case"!>=":case"?>=":vv=">= "+version.version_value;break;default:vv=version.version_value}version.platform&&""!=version.platform&&(vv+=" on "+version.platform),status[vendor_name][product_name][vn]||(status[vendor_name][product_name][vn]={}),status[vendor_name][product_name][vn][cat]||(status[vendor_name][product_name][vn][cat]=[]),status[vendor_name][product_name][vn][cat].push(vv)}}}return status},appliesTo:function(affects){var ret=[];for(var vendor of affects.vendor.vendor_data){vendor.vendor_name;for(var product of vendor.product.product_data){var product_name=product.product_name;for(var version of product.version.version_data){version.version_value,vn="";if(version.version_name&&""!=version.version_name&&(vn=version.version_name),version.version_affected)switch(version.version_affected.startsWith("?")?cat="unknown":version.version_affected.startsWith("!")&&(cat="no"),version.version_affected){case"=":case"<":case">":case"<=":case">=":ret.push(product_name+" "+vn)}}}}return ret},affectedYesNo:function(affects){var status={yes:[],no:[],unknown:[]};for(var vendor of affects.vendor.vendor_data){vendor.vendor_name;for(var product of vendor.product.product_data){var product_name=product.product_name;for(var version of product.version.version_data){var vv=version.version_value,cat="yes";vn="";if(version.version_name&&""!=version.version_name&&(vn=version.version_name),version.version_affected){switch(version.version_affected.startsWith("?")?cat="unknown":version.version_affected.startsWith("!")&&(cat="no"),version.version_affected){case"!":case"?":case"=":vv=version.version_value;break;case"<":case"!<":case"?<":vv="< "+version.version_value;break;case">":case"?>":vv="> "+version.version_value;break;case"<=":case"!<=":case"?<=":vv="<= "+version.version_value;break;case">=":case"!>=":case"?>=":vv=">= "+version.version_value;break;default:vv=version.version_value}version.platform&&""!=version.platform&&(vv+=" on "+version.platform)}var ph=status[cat][product_name];void 0==ph&&(ph=status[cat][product_name]={}),vns=ph.version_names,void 0==vns&&(vns=ph.version_names=[]),vns.indexOf(vn)<0&&vns.push(vn),vvs=ph.version_values,void 0==vvs&&(vvs=ph.version_values=[]),vvs.indexOf(vv)<0&&vvs.push(vv)}}}var rstatus={yes:[],no:[],unknown:[]};for(var cat of["yes","no","unknown"])for(var p in status[cat])rstatus[cat].push({product:p,version_names:status[cat][p].version_names,version_values:status[cat][p].version_values});return rstatus},mergeJSON:function(target,add){function isObject(obj){if("object"==typeof obj)for(var key in obj)if(obj.hasOwnProperty(key))return!0;return!1}for(var key in add)"__proto__"!==key&&"constructor"!==key&&add.hasOwnProperty(key)&&(target[key]&&isObject(target[key])&&isObject(add[key])?this.mergeJSON(target[key],add[key]):target[key]=add[key]);return target},timeSince:function(date){var seconds=Math.floor((new Date-date)/1e3),interval=Math.floor(seconds/31536e3);return interval>1?interval+" years":(interval=Math.floor(seconds/2592e3))>1?interval+" months":(interval=Math.floor(seconds/86400))>1?interval+" days":(interval=Math.floor(seconds/3600))>1?interval+" hours":(interval=Math.floor(seconds/60))>1?interval+" minutes":Math.floor(seconds)+" seconds"},nextPatchDay:function(dateString,weekday){for(var date=new Date(dateString),monthstogo=(12-date.getMonth())%3,count=0,idate=new Date(date.getFullYear(),date.getMonth()+monthstogo,1);idate.getDay()!==weekday||2!=++count;)idate.setDate(idate.getDate()+1);return idate<date?this.nextPatchDay(date.setMonth(date.getMonth()+1),weekday):idate},deep_value:function(obj,path){for(var ret=obj,i=0,len=(path=path.split(".")).length;i<len&&void 0!==(ret=ret[path[i]]);i++);return ret},getDocuments:async function(schemaName,ids,paths){const res=await fetch("/"+schemaName+"/json/",{method:"POST",credentials:"include",headers:{Accept:"application/json, text/plain, */*","Content-Type":"application/json"},redirect:"error",body:JSON.stringify({ids:ids,fields:paths})});return await res.json()},diffline:function(line1,line2){for(var ret1=[],ret2=[],s=0,m=line1.length-1,n=line2.length-1;s<=m&&s<=n&&line1.charAt(s)==line2.charAt(s);)s++;for(;s<=m&&s<=n&&line1.charAt(m)==line2.charAt(n);)m--,n--;return s<=m?(ret1.push({t:0,str:line1.substring(0,s)}),ret1.push({t:1,str:line1.substring(s,m+1)}),ret1.push({t:0,str:line1.substring(m+1,line1.length)})):ret1.push({t:0,str:line1}),s<=n?(ret2.push({t:0,str:line2.substring(0,s)}),ret2.push({t:1,str:line2.substring(s,n+1)}),ret2.push({t:0,str:line2.substring(n+1,line2.length)})):ret2.push({t:0,str:line2}),{lhs:ret1,rhs:ret2}},fileSize:function(a,b,c,d,e){return(b=Math,c=b.log,d=1024,e=c(a)/c(d)|0,a/b.pow(d,e)).toFixed(2)+" "+(e?"KMGTPEZY"[--e]+"B":"Bytes")}};"undefined"!=typeof module&&(module.exports=textUtil);var cvssjs={vectorMap4:{attackVector:"AV",attackComplexity:"AC",attackRequirements:"AT",privilegesRequired:"PR",userInteraction:"UI",vulnConfidentialityImpact:"VC",vulnIntegrityImpact:"VI",vulnAvailabilityImpact:"VA",subConfidentialityImpact:"SC",subIntegrityImpact:"SI",subAvailabilityImpact:"SA",Safety:"S",Automatable:"AU",Recovery:"R",valueDensity:"V",vulnerabilityResponseEffort:"RE",providerUrgency:"U",exploitMaturity:"E"},metricMap4:{AV:"attackVector",AC:"attackComplexity",AT:"attackRequirements",PR:"privilegesRequired",UI:"userInteraction",VC:"vulnConfidentialityImpact",VI:"vulnIntegrityImpact",VA:"vulnAvailabilityImpact",SC:"subConfidentialityImpact",SI:"subIntegrityImpact",SA:"subAvailabilityImpact",S:"Safety",AU:"Automatable",R:"Recovery",V:"valueDensity",RE:"vulnerabilityResponseEffort",U:"providerUrgency",E:"exploitMaturity"},vectorMap3:{attackVector:"AV",attackComplexity:"AC",privilegesRequired:"PR",userInteraction:"UI",scope:"S",confidentialityImpact:"C",integrityImpact:"I",availabilityImpact:"A"},vectorMap2:{accessVector:"AV",accessComplexity:"AC",authentication:"Au",confidentialityImpact:"C",integrityImpact:"I",availabilityImpact:"A"},Weight:{attackVector:{NETWORK:.85,ADJACENT_NETWORK:.62,LOCAL:.55,PHYSICAL:.2},attackComplexity:{HIGH:.44,LOW:.77},privilegesRequired:{UNCHANGED:{NONE:.85,LOW:.62,HIGH:.27},CHANGED:{NONE:.85,LOW:.68,HIGH:.5}},userInteraction:{NONE:.85,REQUIRED:.62},scope:{UNCHANGED:6.42,CHANGED:7.52},confidentialityImpact:{NONE:0,LOW:.22,HIGH:.56},integrityImpact:{NONE:0,LOW:.22,HIGH:.56},availabilityImpact:{NONE:0,LOW:.22,HIGH:.56}},valueMap:{GREEN:"Green",RED:"Red",CLEAR:"Clear",AMBER:"Amber"},cvss:{},m:function(m){var metric=this.metricMap4[m];return metric&&this.cvss[metric]?(console.log(["M:",m,this.valueMap[this.cvss[metric]]||this.cvss[metric].charAt(0)]),this.valueMap[this.cvss[metric]]||this.cvss[metric].charAt(0)):(console.log("M:",m,"X!"),"X")},vector4:function(cvss){var r="CVSS:4.0";for(var m in this.vectorMap4)this.vectorMap4[m]&&cvss[m]&&"NOT_DEFINED"!=cvss[m]&&(r+="/"+this.vectorMap4[m]+":"+(this.valueMap[cvss[m]]||cvss[m].charAt(0)));return r},vector3:function(cvss){var r="CVSS:3.1";for(var m in cvss)this.vectorMap3[m]&&cvss[m]&&(r+="/"+this.vectorMap3[m]+":"+cvss[m].charAt(0));return r},vector2:function(cvss){var r=[];for(var m in cvss)this.vectorMap2[m]&&cvss[m]&&r.push(this.vectorMap2[m]+":"+cvss[m].charAt(0));return r.join("/")},CVSSseveritys:[{name:"NONE",bottom:0,top:0},{name:"LOW",bottom:.1,top:3.9},{name:"MEDIUM",bottom:4,top:6.9},{name:"HIGH",bottom:7,top:8.9},{name:"CRITICAL",bottom:9,top:10}],severityLevel:function(score){return 0==score?"NONE":score<=3.9?"LOW":score<=6.9?"MEDIUM":score<=8.9?"HIGH":"CRITICAL"},severity:function(score){var i,severityRatingLength=this.CVSSseveritys.length;for(i=0;i<severityRatingLength;i++)if(score>=this.CVSSseveritys[i].bottom&&score<=this.CVSSseveritys[i].top)return this.CVSSseveritys[i];return{name:"?",bottom:"Not",top:"defined"}},roundUp1:function(input){var int_input=Math.round(1e5*input);return int_input%1e4==0?int_input/1e5:(Math.floor(int_input/1e4)+1)/10},v4const:{lookup:{"000000":10,"000001":9.9,"000010":9.8,"000011":9.5,"000020":9.5,"000021":9.2,"000100":10,"000101":9.6,"000110":9.3,"000111":8.7,"000120":9.1,"000121":8.1,"000200":9.3,"000201":9,"000210":8.9,"000211":8,"000220":8.1,"000221":6.8,"001000":9.8,"001001":9.5,"001010":9.5,"001011":9.2,"001020":9,"001021":8.4,"001100":9.3,"001101":9.2,"001110":8.9,"001111":8.1,"001120":8.1,"001121":6.5,"001200":8.8,"001201":8,"001210":7.8,"001211":7,"001220":6.9,"001221":4.8,"002001":9.2,"002011":8.2,"002021":7.2,"002101":7.9,"002111":6.9,"002121":5,"002201":6.9,"002211":5.5,"002221":2.7,"010000":9.9,"010001":9.7,"010010":9.5,"010011":9.2,"010020":9.2,"010021":8.5,"010100":9.5,"010101":9.1,"010110":9,"010111":8.3,"010120":8.4,"010121":7.1,"010200":9.2,"010201":8.1,"010210":8.2,"010211":7.1,"010220":7.2,"010221":5.3,"011000":9.5,"011001":9.3,"011010":9.2,"011011":8.5,"011020":8.5,"011021":7.3,"011100":9.2,"011101":8.2,"011110":8,"011111":7.2,"011120":7,"011121":5.9,"011200":8.4,"011201":7,"011210":7.1,"011211":5.2,"011220":5,"011221":3,"012001":8.6,"012011":7.5,"012021":5.2,"012101":7.1,"012111":5.2,"012121":2.9,"012201":6.3,"012211":2.9,"012221":1.7,100000:9.8,100001:9.5,100010:9.4,100011:8.7,100020:9.1,100021:8.1,100100:9.4,100101:8.9,100110:8.6,100111:7.4,100120:7.7,100121:6.4,100200:8.7,100201:7.5,100210:7.4,100211:6.3,100220:6.3,100221:4.9,101000:9.4,101001:8.9,101010:8.8,101011:7.7,101020:7.6,101021:6.7,101100:8.6,101101:7.6,101110:7.4,101111:5.8,101120:5.9,101121:5,101200:7.2,101201:5.7,101210:5.7,101211:5.2,101220:5.2,101221:2.5,102001:8.3,102011:7,102021:5.4,102101:6.5,102111:5.8,102121:2.6,102201:5.3,102211:2.1,102221:1.3,110000:9.5,110001:9,110010:8.8,110011:7.6,110020:7.6,110021:7,110100:9,110101:7.7,110110:7.5,110111:6.2,110120:6.1,110121:5.3,110200:7.7,110201:6.6,110210:6.8,110211:5.9,110220:5.2,110221:3,111000:8.9,111001:7.8,111010:7.6,111011:6.7,111020:6.2,111021:5.8,111100:7.4,111101:5.9,111110:5.7,111111:5.7,111120:4.7,111121:2.3,111200:6.1,111201:5.2,111210:5.7,111211:2.9,111220:2.4,111221:1.6,112001:7.1,112011:5.9,112021:3,112101:5.8,112111:2.6,112121:1.5,112201:2.3,112211:1.3,112221:.6,200000:9.3,200001:8.7,200010:8.6,200011:7.2,200020:7.5,200021:5.8,200100:8.6,200101:7.4,200110:7.4,200111:6.1,200120:5.6,200121:3.4,200200:7,200201:5.4,200210:5.2,200211:4,200220:4,200221:2.2,201000:8.5,201001:7.5,201010:7.4,201011:5.5,201020:6.2,201021:5.1,201100:7.2,201101:5.7,201110:5.5,201111:4.1,201120:4.6,201121:1.9,201200:5.3,201201:3.6,201210:3.4,201211:1.9,201220:1.9,201221:.8,202001:6.4,202011:5.1,202021:2,202101:4.7,202111:2.1,202121:1.1,202201:2.4,202211:.9,202221:.4,210000:8.8,210001:7.5,210010:7.3,210011:5.3,210020:6,210021:5,210100:7.3,210101:5.5,210110:5.9,210111:4,210120:4.1,210121:2,210200:5.4,210201:4.3,210210:4.5,210211:2.2,210220:2,210221:1.1,211000:7.5,211001:5.5,211010:5.8,211011:4.5,211020:4,211021:2.1,211100:6.1,211101:5.1,211110:4.8,211111:1.8,211120:2,211121:.9,211200:4.6,211201:1.8,211210:1.7,211211:.7,211220:.8,211221:.2,212001:5.3,212011:2.4,212021:1.4,212101:2.4,212111:1.2,212121:.5,212201:1,212211:.3,212221:.1},maxComposed:{eq1:{0:["AV:N/PR:N/UI:N/"],1:["AV:A/PR:N/UI:N/","AV:N/PR:L/UI:N/","AV:N/PR:N/UI:P/"],2:["AV:P/PR:N/UI:N/","AV:A/PR:L/UI:P/"]},eq2:{0:["AC:L/AT:N/"],1:["AC:H/AT:N/","AC:L/AT:P/"]},eq3:{0:{0:["VC:H/VI:H/VA:H/CR:H/IR:H/AR:H/"],1:["VC:H/VI:H/VA:L/CR:M/IR:M/AR:H/","VC:H/VI:H/VA:H/CR:M/IR:M/AR:M/"]},1:{0:["VC:L/VI:H/VA:H/CR:H/IR:H/AR:H/","VC:H/VI:L/VA:H/CR:H/IR:H/AR:H/"],1:["VC:L/VI:H/VA:L/CR:H/IR:M/AR:H/","VC:L/VI:H/VA:H/CR:H/IR:M/AR:M/","VC:H/VI:L/VA:H/CR:M/IR:H/AR:M/","VC:H/VI:L/VA:L/CR:M/IR:H/AR:H/","VC:L/VI:L/VA:H/CR:H/IR:H/AR:M/"]},2:{1:["VC:L/VI:L/VA:L/CR:H/IR:H/AR:H/"]}},eq4:{0:["SC:H/SI:S/SA:S/"],1:["SC:H/SI:H/SA:H/"],2:["SC:L/SI:L/SA:L/"]},eq5:{0:["E:A/"],1:["E:P/"],2:["E:U/"]}},maxHamming:{eq1:{0:1,1:4,2:5},eq2:{0:1,1:2},eq3:{0:{0:7,1:6},1:{0:8,1:8},2:{1:10}},eq4:{0:6,1:5,2:4},eq5:{0:1,1:1,2:1}},eq1:"",eq2:"",eq3:"",eq4:"",eq5:"",eq6:""},macroVector:function(){return console.log(this.cvss),"N"==this.m("AV")&&"N"==this.m("PR")&&"N"==this.m("UI")?this.v4const.eq1="0":"N"!=this.m("AV")&&"N"!=this.m("PR")&&"N"!=this.m("UI")||"N"==this.m("AV")&&"N"==this.m("PR")&&"N"==this.m("UI")||"P"==this.m("AV")?"P"==this.m("AV")||"N"!=this.m("AV")&&"N"!=this.m("PR")&&"N"!=this.m("UI")?this.v4const.eq1="2":(console.log("Error computing EQ1"),this.v4const.eq1=9):this.v4const.eq1="1","L"==this.m("AC")&&"N"==this.m("AT")?this.v4const.eq2="0":"L"!=this.m("AC")||"N"!=this.m("AT")?this.v4const.eq2="1":(console.log("Error computing EQ2"),this.v4const.eq2=9),"H"==this.m("VC")&&"H"==this.m("VI")?this.v4const.eq3=0:"H"==this.m("VC")&&"H"==this.m("VI")||"H"!=this.m("VC")&&"H"!=this.m("VI")&&"H"!=this.m("VA")?"H"!=this.m("VC")&&"H"!=this.m("VI")&&"H"!=this.m("VA")?this.v4const.eq3=2:(console.log("Error computing EQ3"),this.v4const.eq3=9):this.v4const.eq3=1,"S"==this.m("MSI")||"S"==this.m("MSA")?this.v4const.eq4=0:"H"==this.m("SC")||"H"==this.m("SI")||"H"==this.m("SA")&&"S"!=this.m("MSI")&&"S"!=this.m("MSA")?this.v4const.eq4=1:"L"!=this.m("SC")&&"N"!=this.m("SC")||"L"!=this.m("SI")&&"N"!=this.m("SI")||"L"!=this.m("SA")&&"N"!=this.m("SA")?(console.log("Error computing EQ4"),this.v4const.eq4=2):this.v4const.eq4=2,"A"==this.m("E")?this.v4const.eq5=0:"P"==this.m("E")?this.v4const.eq5=1:"U"==this.m("E")?this.v4const.eq5=2:(console.log("Error computing EQ5"),this.v4const.eq5=9),"H"==this.m("CR")&&"H"==this.m("VC")||"H"==this.m("IR")&&"H"==this.m("VI")||"H"==this.m("AR")&&"H"==this.m("VA")?this.v4const.eq6=0:"H"==this.m("CR")&&"H"==this.m("VC")||"H"==this.m("IR")&&"H"==this.m("VI")||"H"==this.m("AR")&&"H"==this.m("VA")?(console.log("Error computing EQ6"),this.v4const.eq6=9):this.v4const.eq6=1,this.v4const.eq1+this.v4const.eq2+this.v4const.eq3+this.v4const.eq4+this.v4const.eq5+this.v4const.eq6},getvalueEqLookup:function(lookup,i){var eq=lookup[i],eq_val=this.v4const.maxComposed["eq"+String(i+1)][eq];return console.log(["getValueEq",i,eq,"eq"+String(i+1),eq_val]),eq_val},extractValueMetric:function(metric,str){return extracted=str.slice(str.indexOf(metric)+metric.length+1),extracted.indexOf("/")>0?metric_val=extracted.substring(0,extracted.indexOf("/")):metric_val=extracted,metric_val},calculate4:function(cvss){if(cvss.exploitMaturity||(cvss.exploitMaturity="UNDEFINED"),this.cvss=cvss,console.log("GOT CVSS",cvss),lookuptable=this.v4const.lookup,AV_levels={N:0,A:.1,L:.2,P:.3},PR_levels={N:0,L:.1,H:.2},UI_levels={N:0,P:.1,A:.2},AC_levels={L:0,H:.1},AT_levels={N:0,P:.1},VC_levels={H:0,L:.1,N:.2},VI_levels={H:0,L:.1,N:.2},VA_levels={H:0,L:.1,N:.2},SC_levels={H:.1,L:.2,N:.3},SI_levels={S:0,H:.1,L:.2,N:.3},SA_levels={S:0,H:.1,L:.2,N:.3},CR_levels={H:0,M:.1,L:.2},IR_levels={H:0,M:.1,L:.2},AR_levels={H:0,M:.1,L:.2},E_levels={U:.2,P:.1,A:0},lookup=this.macroVector(),console.log("Lookup:",lookup),["vulnConfidentialityImpact","vulnIntegrityImpact","vulnAvailabilityImpact","subConfidentialityImpact","subIntegrityImpact","subAvailabilityImpact"].every(met=>"NONE"==cvss[met]))return 0;for(eq1_max of(value=lookuptable[lookup],eq1_val=lookup[0],eq2_val=lookup[1],eq3_val=lookup[2],eq4_val=lookup[3],eq5_val=lookup[4],eq6_val=lookup[5],eq1_next_lower_macro="".concat(eq1_val+1,eq2_val,eq3_val,eq4_val,eq5_val,eq6_val),eq2_next_lower_macro="".concat(eq1_val,eq2_val+1,eq3_val,eq4_val,eq5_val,eq6_val),1==this.v4const.eq3&&1==this.v4const.eq6?eq3eq6_next_lower_macro="".concat(eq1_val,eq2_val,eq3_val+1,eq4_val,eq5_val,eq6_val):0==this.v4const.eq3&&1==this.v4const.eq6?eq3eq6_next_lower_macro="".concat(eq1_val,eq2_val,eq3_val+1,eq4_val,eq5_val,eq6_val):1==this.v4const.eq3&&0==this.v4const.eq6?eq3eq6_next_lower_macro="".concat(eq1_val,eq2_val,eq3_val,eq4_val,eq5_val,eq6_val+1):0==this.v4const.eq3&&0==this.v4const.eq6?(eq3eq6_next_lower_macro_left="".concat(eq1_val,eq2_val,eq3_val,eq4_val,eq5_val,eq6_val+1),eq3eq6_next_lower_macro_right="".concat(eq1_val,eq2_val,eq3_val+1,eq4_val,eq5_val,eq6_val)):eq3eq6_next_lower_macro="".concat(eq1_val,eq2_val,eq3_val+1,eq4_val,eq5_val,eq6_val+1),eq4_next_lower_macro="".concat(eq1_val,eq2_val,eq3_val,eq4_val+1,eq5_val,eq6_val),eq5_next_lower_macro="".concat(eq1_val,eq2_val,eq3_val,eq4_val,eq5_val+1,eq6_val),score_eq1_next_lower_macro=lookuptable[eq1_next_lower_macro],score_eq2_next_lower_macro=lookuptable[eq2_next_lower_macro],0==this.v4const.eq3&&0==this.v4const.eq6?(score_eq3eq6_next_lower_macro_left=lookuptable[eq3eq6_next_lower_macro_left],score_eq3eq6_next_lower_macro_right=lookuptable[eq3eq6_next_lower_macro_right],score_eq3eq6_next_lower_macro_left>score_eq3eq6_next_lower_macro_right?score_eq3eq6_next_lower_macro=score_eq3eq6_next_lower_macro_left:score_eq3eq6_next_lower_macro=score_eq3eq6_next_lower_macro_right):score_eq3eq6_next_lower_macro=lookuptable[eq3eq6_next_lower_macro],score_eq4_next_lower_macro=lookuptable[eq4_next_lower_macro],score_eq5_next_lower_macro=lookuptable[eq5_next_lower_macro],eq1_maxes=this.getvalueEqLookup(lookup,0),eq2_maxes=this.getvalueEqLookup(lookup,1),eq3_eq6_maxes=this.getvalueEqLookup(lookup,2)[lookup[5]],eq4_maxes=this.getvalueEqLookup(lookup,3),eq5_maxes=this.getvalueEqLookup(lookup,4),max_vectors=[],eq1_maxes))for(eq2_max of eq2_maxes)for(eq3_eq6_max of eq3_eq6_maxes)for(eq4_max of eq4_maxes)for(eq5max of eq5_maxes)max_vectors.push(eq1_max+eq2_max+eq3_eq6_max+eq4_max);if(void 0==max_vectors)return"0.0";for(let i=0;i<max_vectors.length&&(tmp_vector=max_vectors[i],hamming_distance_AV=AV_levels[this.m("AV")]-AV_levels[this.extractValueMetric("AV",tmp_vector)],hamming_distance_PR=PR_levels[this.m("PR")]-PR_levels[this.extractValueMetric("PR",tmp_vector)],hamming_distance_UI=UI_levels[this.m("UI")]-UI_levels[this.extractValueMetric("UI",tmp_vector)],hamming_distance_AC=AC_levels[this.m("AC")]-AC_levels[this.extractValueMetric("AC",tmp_vector)],hamming_distance_AT=AT_levels[this.m("AT")]-AT_levels[this.extractValueMetric("AT",tmp_vector)],hamming_distance_VC=VC_levels[this.m("VC")]-VC_levels[this.extractValueMetric("VC",tmp_vector)],hamming_distance_VI=VI_levels[this.m("VI")]-VI_levels[this.extractValueMetric("VI",tmp_vector)],hamming_distance_VA=VA_levels[this.m("VA")]-VA_levels[this.extractValueMetric("VA",tmp_vector)],"S"==this.m("MSI")&&"S"==this.m("MSA")?(hamming_distance_SI=SI_levels[this.m("MSI")]-SI_levels[this.extractValueMetric("SI",tmp_vector)],hamming_distance_SA=SA_levels[this.m("MSA")]-SA_levels[this.extractValueMetric("SA",tmp_vector)]):"S"==this.m("MSI")?(hamming_distance_SI=SI_levels[this.m("MSI")]-SI_levels[this.extractValueMetric("SI",tmp_vector)],hamming_distance_SA=SA_levels[this.m("SA")]-SA_levels[this.extractValueMetric("SA",tmp_vector)]):"S"==this.m("MSA")?(hamming_distance_SI=SI_levels[this.m("SI")]-SI_levels[this.extractValueMetric("SI",tmp_vector)],hamming_distance_SA=SA_levels[this.m("MSA")]-SA_levels[this.extractValueMetric("SA",tmp_vector)]):(hamming_distance_SI=SI_levels[this.m("SI")]-SI_levels[this.extractValueMetric("SI",tmp_vector)],hamming_distance_SA=SA_levels[this.m("SA")]-SA_levels[this.extractValueMetric("SA",tmp_vector)]),hamming_distance_SC=SC_levels[this.m("SC")]-SC_levels[this.extractValueMetric("SC",tmp_vector)],hamming_distance_CR=CR_levels[this.m("CR")]-CR_levels[this.extractValueMetric("CR",tmp_vector)],hamming_distance_IR=IR_levels[this.m("IR")]-IR_levels[this.extractValueMetric("IR",tmp_vector)],hamming_distance_AR=AR_levels[this.m("AR")]-AR_levels[this.extractValueMetric("AR",tmp_vector)],hamming_distance_AV<0||hamming_distance_PR<0||hamming_distance_UI<0||hamming_distance_AC<0||hamming_distance_AT<0||hamming_distance_VC<0||hamming_distance_VI<0||hamming_distance_VA<0||hamming_distance_SC<0||hamming_distance_SI<0||hamming_distance_SA<0||hamming_distance_CR<0||hamming_distance_IR<0||hamming_distance_AR<0);i++);return current_hamming_distance_eq1=hamming_distance_AV+hamming_distance_PR+hamming_distance_UI,current_hamming_distance_eq2=hamming_distance_AC+hamming_distance_AT,current_hamming_distance_eq3eq6=hamming_distance_VC+hamming_distance_VI+hamming_distance_VA+hamming_distance_CR+hamming_distance_IR+hamming_distance_AR,current_hamming_distance_eq4=hamming_distance_SC+hamming_distance_SI+hamming_distance_SA,current_hamming_distance_eq5=0,step=.1,available_distance_eq1=value-score_eq1_next_lower_macro,available_distance_eq2=value-score_eq2_next_lower_macro,available_distance_eq3eq6=value-score_eq3eq6_next_lower_macro,available_distance_eq4=value-score_eq4_next_lower_macro,available_distance_eq5=value-score_eq5_next_lower_macro,percent_to_next_eq1_hamming=0,percent_to_next_eq2_hamming=0,percent_to_next_eq3eq6_hamming=0,percent_to_next_eq4_hamming=0,percent_to_next_eq5_hamming=0,n_existing_lower=0,normalized_hamming_eq1=0,normalized_hamming_eq2=0,normalized_hamming_eq3eq6=0,normalized_hamming_eq4=0,normalized_hamming_eq5=0,maxHamming_eq1=this.v4const.maxHamming.eq1[String(eq1_val)]*step,maxHamming_eq2=this.v4const.maxHamming.eq2[String(eq2_val)]*step,maxHamming_eq3eq6=this.v4const.maxHamming.eq3[String(eq3_val)][String(eq6_val)]*step,maxHamming_eq4=this.v4const.maxHamming.eq4[String(eq4_val)]*step,isNaN(available_distance_eq1)||(n_existing_lower+=1,percent_to_next_eq1_hamming=current_hamming_distance_eq1/maxHamming_eq1,isNaN(percent_to_next_eq1_hamming)&&(percent_to_next_eq1_hamming=0),normalized_hamming_eq1=available_distance_eq1*percent_to_next_eq1_hamming),isNaN(available_distance_eq2)||(n_existing_lower+=1,percent_to_next_eq2_hamming=current_hamming_distance_eq2/maxHamming_eq2,isNaN(percent_to_next_eq2_hamming)&&(percent_to_next_eq2_hamming=0),normalized_hamming_eq2=available_distance_eq2*percent_to_next_eq2_hamming),isNaN(available_distance_eq3eq6)||(n_existing_lower+=1,percent_to_next_eq3eq6_hamming=current_hamming_distance_eq3eq6/maxHamming_eq3eq6,isNaN(percent_to_next_eq3eq6_hamming)&&(percent_to_next_eq3eq6_hamming=0),normalized_hamming_eq3eq6=available_distance_eq3eq6*percent_to_next_eq3eq6_hamming),isNaN(available_distance_eq4)||(n_existing_lower+=1,percent_to_next_eq4_hamming=current_hamming_distance_eq4/maxHamming_eq4,isNaN(percent_to_next_eq4_hamming)&&(percent_to_next_eq4_hamming=0),normalized_hamming_eq4=available_distance_eq4*percent_to_next_eq4_hamming),isNaN(available_distance_eq5)||(n_existing_lower+=1,percent_to_next_eq5_hamming=0,isNaN(percent_to_next_eq5_hamming)&&(percent_to_next_eq5_hamming=0),normalized_hamming_eq5=available_distance_eq5*percent_to_next_eq5_hamming),0==n_existing_lower?mean_distance=0:mean_distance=(normalized_hamming_eq1+normalized_hamming_eq2+normalized_hamming_eq3eq6+normalized_hamming_eq4+normalized_hamming_eq5)/n_existing_lower,value=parseFloat(value)-parseFloat(mean_distance),value<0&&(value=0),value>10&&(value=10),value.toFixed(1)},calculate3:function(cvss){var p,val={},metricWeight={};try{for(p in this.Weight){if(val[p]=cvss[p],void 0===val[p]||""===val[p]||null==val[p])return"?";metricWeight[p]=this.Weight[p][val[p]]}}catch(err){return err}metricWeight.privilegesRequired=this.Weight.privilegesRequired[val.scope][val.privilegesRequired];try{var impactSubScore,exploitability,impactSubScoreMultiplier=1-(1-metricWeight.confidentialityImpact)*(1-metricWeight.integrityImpact)*(1-metricWeight.availabilityImpact);return impactSubScore="UNCHANGED"===val.scope?metricWeight.scope*impactSubScoreMultiplier:metricWeight.scope*(impactSubScoreMultiplier-.029)-3.25*Math.pow(impactSubScoreMultiplier-.02,15),exploitability=8.22*metricWeight.attackVector*metricWeight.attackComplexity*metricWeight.privilegesRequired*metricWeight.userInteraction,(impactSubScore<=0?0:"UNCHANGED"===val.scope?this.roundUp1(Math.min(exploitability+impactSubScore,10)):this.roundUp1(Math.min(1.08*(exploitability+impactSubScore),10))).toFixed(1)}catch(err){return err}},w2:{accessComplexity:{HIGH:.35,MEDIUM:.61,LOW:.71},authentication:{NONE:.704,SINGLE:.56,MULTIPLE:.45},accessVector:{LOCAL:.395,ADJACENT_NETWORK:.646,NETWORK:1},confidentialityImpact:{NONE:0,PARTIAL:.275,COMPLETE:.66},integrityImpact:{NONE:0,PARTIAL:.275,COMPLETE:.66},availabilityImpact:{NONE:0,PARTIAL:.275,COMPLETE:.66}},calculate2:function(cvss){var w2=this.w2,impact=10.41*(1-(1-w2.confidentialityImpact[cvss.confidentialityImpact])*(1-w2.integrityImpact[cvss.integrityImpact])*(1-w2.availabilityImpact[cvss.availabilityImpact]));return 0==impact?0:(1.176*(.6*impact+.4*(20*w2.accessComplexity[cvss.accessComplexity]*w2.authentication[cvss.authentication]*w2.accessVector[cvss.accessVector])-1.5)).toFixed(1)}};